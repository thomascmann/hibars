function hibars2(a){function N(a,b,c,d,e){var f=[];A.selectAll(a).style("font-size","1px").each(function(){var a=this.getBBox();null==a.width&&(a.width=10),null==a.height&&(a.height=1);var d=Math.min(b/a.width,c);if(f.push(d),e){var g=Math.min(e/a.height,c);f.push(g)}});var g;g=d?Math.max(d3.min(f),d)+"px":d3.min(f)+"px",A.selectAll(a).style("font-size",g)}var s,b="#"+a.location,c=a.datafile,d=a.dependent,e=a.factor1,f=a.factor2,g=a.chartwidth||800,h=a.chartheight||500,k=a.colorscheme||colorpalettes.defaultcolors,l=a.auto_size||"no",m={top:.04*h,right:.025*g,bottom:.12*h,left:.09375*g,legend:.15*g},n=g-m.left-m.right-m.legend,p=(g-m.left-m.right,h-m.top-m.bottom),q=.1,t=d3.scaleBand().rangeRound([0,n]).padding(q),u=d3.scaleBand(),v=d3.scaleLinear().range([p,0]),x=2,y=d3.axisBottom().scale(t).tickSize(0).tickPadding(2*m.bottom/3),z=d3.axisLeft().scale(v).tickSizeInner(-n).tickSizeOuter(0).tickPadding(.0125*g);if("no"==l)var A=d3.select(b).style("text-align","center").append("svg").attr("width",n+m.left+m.right+m.legend).attr("height",p+m.top+m.bottom).append("g").attr("transform","translate("+m.left+","+m.top+")");else if("yes"==l)var B=d3.select(b).style("text-align","center").append("div").style("display","inline-block").style("position","relative").style("width","100%").style("padding-bottom","calc(100% * "+h/g+")").style("vertical-align","top").style("overflow","hidden"),A=B.append("svg").attr("viewBox","0 0 "+g+" "+h).attr("preserveAspectRatio","xMinYMin meet").style("display","inline-block").style("position","absolute").style("top","0px").style("left","0px").append("g").attr("transform","translate("+m.left+","+m.top+")");var I,J,C=0,D=0,F=0,G=1,H=1,K=.15*g,L=.05*p;L>20&&(L=20);var M=.9*Math.min(K,L);d3.csv(c,function(a,b){function W(a,e){for(c=d3.nest().key(function(b){return b[a]}).key(function(a){return a[e]}).entries(b),i=0;i<c.length;i++)for(j=0;j<c[i].values.length;j++)c[i].values[j].values[0].stderror=+c[i].values[j].values[0].stderror,c[i].values[j].values[0][d]=+c[i].values[j].values[0][d];t.domain(c.map(function(a){return a.key})).rangeRound([0,n]).padding(q),u.domain(c[0].values.map(function(a){return a.key})).rangeRound([0,t.bandwidth()]),s=c[0].values.length,l.domain(c[0].values.map(function(a){return a.key})),l.range(function(){return k[s]||colorpalettes.defaultcolors[s]}()),A.selectAll(".databar").transition().duration(500).attr("y",1e3).transition().remove(),A.selectAll(".errorline").transition().duration(500).attr("y1",1e3).attr("y2",1e3).transition().remove(),setTimeout(function(){y.scale(t),A.select(".x.axis").call(y),o=o.data([]).exit().remove(),r=r.data([]).exit().remove(),o=A.selectAll(".factor1group").data(c).enter().append("g").attr("class","factor1group").attr("transform",function(a){return"translate("+t(a.key)+",0)"}),r=A.selectAll(".axisticks1").data(c).enter().append("g").attr("class","axisticks1").attr("transform",function(a){return"translate("+t(a.key)+",0)"}),r.filter(function(a,b){return b<c.length-1}).append("line").attr("class","group1tick").attr("x1",t.bandwidth()/2+t.bandwidth()/(2-2*q)).attr("y1",p).attr("x2",t.bandwidth()/2+t.bandwidth()/(2-2*q)).attr("y2",p+m.bottom).attr("stroke","black").attr("stroke-width",.002*h),N(".x0.axis text",t.bandwidth(),.02*g,0,.032*h),A.select("g.x.x0.axis").call(y),w=o.selectAll("rect").data(function(a){return a.values}).enter().append("rect").attr("class","databar").attr("width",u.bandwidth()).attr("height",function(a){return Math.abs(v(a.values[0][d])-v(0))}).style("fill",function(a){return l(a.key)}).attr("x",function(a){return u(a.key)}).attr("y",p).transition().duration(500).attr("y",function(a){return a.values[0][d]>=0?v(a.values[0][d])+50/h:a.values[0][d]<0?v(0)+1-50/h:void 0}),o.selectAll("rect").on("mouseover",function(a){var b=d3.select(this.parentNode).attr("transform"),c=b.substring(b.indexOf("(")+1,b.indexOf(")")).split(","),e=Number(c[0]),f=parseFloat(d3.select(this).attr("x"))+e+u.bandwidth()/2;if(a.values[0][d]>=0)var i=parseFloat(d3.select(this).attr("y"))+1*parseFloat(d3.select(this).attr("height"))/4;else if(a.values[0][d]<0)var i=v(0)+3*parseFloat(d3.select(this).attr("height"))/4;var j=Math.max(u.bandwidth()/3,.02*g,.02*h);A.append("circle").attr("class","tooltip").attr("r",j).attr("cx",f).attr("cy",i).style("fill","aliceblue").style("pointer-events","none").style("stroke","black").style("stroke-width",.002*h+"px").style("stroke-opacity",.8).attr("fill-opacity",.8),A.append("text").attr("class","tooltip").attr("x",f).attr("y",i).attr("dy",Math.min(.4*j,8)+"px").attr("text-anchor","middle").attr("fill","black").style("pointer-events","none").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").text(a.values[0][d]),N("text.tooltip",3*j/2,20,0,3*j/2)}).on("mouseout",function(){d3.selectAll(".tooltip").transition().duration(100).attr("fill-opacity",0).style("stroke-opacity",0).remove()}),B=o.selectAll(".errorbars").data(function(a){return a.values}).enter().append("g").attr("class","errorbars").style("pointer-events","none").attr("transform",function(a){var b=u(a.key)+u.bandwidth()/2;return"translate("+b+", 0 )"}),B.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",x).attr("x1",0).attr("y1",p).attr("x2",0).attr("y2",p).transition().duration(500).attr("x1",0).attr("y1",function(a){var b=a.values[0][d]+a.values[0].stderror;return v(b)}).attr("x2",0).attr("y2",function(a){var b=a.values[0][d]-a.values[0].stderror;return v(b)}),B.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",x).attr("x1",-u.bandwidth()/4).attr("y1",p).attr("x2",u.bandwidth()/4).attr("y2",p).transition().duration(500).attr("x1",-u.bandwidth()/4).attr("y1",function(a){var b=a.values[0][d]+a.values[0].stderror;return v(b)}).attr("x2",u.bandwidth()/4).attr("y2",function(a){var b=a.values[0][d]+a.values[0].stderror;return v(b)}).attr("stroke","black").attr("stroke-width",x),B.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",x).attr("x1",-u.bandwidth()/4).attr("y1",p).attr("x2",u.bandwidth()/4).attr("y2",p).transition().duration(500).attr("x1",-u.bandwidth()/4).attr("y1",function(a){var b=a.values[0][d]-a.values[0].stderror;return v(b)}).attr("x2",u.bandwidth()/4).attr("y2",function(a){var b=a.values[0][d]-a.values[0].stderror;return v(b)}).attr("stroke","black").attr("stroke-width",x),A.selectAll(".errorbars line").style("stroke-width",.004*h),E.data([]).exit().remove(),E=A.selectAll(".legend").data(c[0].values).enter().append("g").attr("class","legend").attr("transform",function(a,b){var c=b*L+L;return"translate(0,"+c+")"}),E.append("rect").attr("x",g-m.left-M).attr("width",M).attr("height",M).style("fill",function(a){return l(a.key)}),E.append("text").attr("x",.991489*(g-m.left-M)).attr("y",M/2).attr("dy",M/3.2).style("text-anchor","end").text(function(a){return a.key}).style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").classed("legendtext",!0).style("font-size","1px"),N("text.legendtext",m.legend-M,16,0,M),O.text(e).attr("class","legendtitle").style("font-weight","none"),N(".legendtitle text",.9*m.legend,16,0,M),d3.selectAll("text.legendtitle").style("font-weight","bold"),P.transition().attr("transform",function(){var a=g-m.left,b=c[0].values.length*L+3*L;return"translate("+a+","+b+")"}),Q.transition().attr("transform",function(){var a=g-m.left,b=c[0].values.length*L+4.7*L;return"translate("+a+","+b+")"}),T.transition().attr("transform",function(a,b){var d=g-m.left-K,e=c[0].values.length*L+b*(L+1)+5*L;return"translate("+d+","+e+")"}),U.transition().attr("transform",function(){var a=g-m.left,b=c[0].values.length*L+R.length*(L+1)+6.7*L;return"translate("+a+","+b+")"}),V.transition().attr("transform",function(a,b){var d=g-m.left-K,e=c[0].values.length*L+R.length*(L+1)+b*(L+1)+7*L;return"translate("+d+","+e+")"}),T.filter(function(a,b){return"morphbutton0"==d3.select(this).attr("class")}).selectAll("text").text("Flip "+e),T.filter(function(a,b){return"morphbutton1"==d3.select(this).attr("class")}).selectAll("text").text("Flip "+a),F=0},500)}if(a)throw a;var c=d3.nest().key(function(a){return a[e]}).key(function(a){return a[f]}).entries(b);for(i=0;i<c.length;i++)for(j=0;j<c[i].values.length;j++)c[i].values[j].values[0].stderror=+c[i].values[j].values[0].stderror,c[i].values[j].values[0][d]=+c[i].values[j].values[0][d];t.domain(c.map(function(a){return a.key})),u.domain(c[0].values.map(function(a){return a.key})).rangeRound([0,t.bandwidth()]),s=c[0].values.length;var l=d3.scaleOrdinal().range(function(){return k[s]||colorpalettes.defaultcolors[s]}());v.domain([Math.min(0,d3.min(c,function(a){return d3.min(a.values,function(a){return d3.min(a.values,function(a){return a[d]-a.stderror})})})),Math.max(0,d3.max(c,function(a){return d3.max(a.values,function(a){return d3.max(a.values,function(a){return a[d]+a.stderror})})}))]).nice(),A.append("g").attr("class","x x0 axis").attr("transform","translate(0,"+p+")").call(y),A.append("g").attr("class","y axis").call(z.tickFormat(d3.format(".0s"))),A.append("text").attr("transform","rotate(-90)").attr("x",-p/2).attr("y",-(m.left-.00625*g)).attr("dy",.25*m.left).style("text-anchor","middle").text(d).style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").style("font-size","1px").style("font-size",function(a){var b=this.getBBox(),e=(b.width,b.height,Math.min(p/(b.width+1),n/(b.height+1),20,.04*h,.04*g));return e+"px"});var o=A.selectAll(".factor1group").data(c).enter().append("g").attr("class","factor1group").attr("transform",function(a){return"translate("+t(a.key)+",0)"}),r=A.selectAll(".axisticks1").data(c).enter().append("g").attr("class","axisticks1").attr("transform",function(a){return"translate("+t(a.key)+",0)"});r.filter(function(a,b){return b<c.length-1}).append("line").attr("class","group1tick").attr("x1",t.bandwidth()/2+t.bandwidth()/(2-2*q)).attr("y1",p).attr("x2",t.bandwidth()/2+t.bandwidth()/(2-2*q)).attr("y2",p+m.bottom).attr("stroke","black").attr("stroke-width",.002*h),N(".x0.axis text",t.bandwidth(),.02*g,0,.032*h),A.select("g.x.x0.axis").call(y),A.selectAll("g.tick").filter(function(a){return 0!=a}).select("line").style("opacity","0.2"),A.selectAll("g.tick").select("line").attr("stroke-width",.002*h),A.selectAll(".axis path").attr("stroke-width",.002*h),A.selectAll(".y.axis").style("font-size",function(){return Math.min(.032*h,.032*g,16)+"px"});var w=o.selectAll("rect").data(function(a){return a.values}).enter().append("rect").attr("class","databar").attr("width",u.bandwidth()).attr("height",function(a){return Math.abs(v(a.values[0][d])-v(0))}).style("fill",function(a){return l(a.key)}).attr("x",function(a){return u(a.key)}).attr("y",p).transition().duration(500).attr("y",function(a){return a.values[0][d]>=0?v(a.values[0][d])+50/h:a.values[0][d]<0?v(0)+1-50/h:void 0});o.selectAll("rect").on("mouseover",function(a){var b=d3.select(this.parentNode).attr("transform"),c=b.substring(b.indexOf("(")+1,b.indexOf(")")).split(","),e=Number(c[0]),f=parseFloat(d3.select(this).attr("x"))+e+u.bandwidth()/2;if(a.values[0][d]>=0)var i=parseFloat(d3.select(this).attr("y"))+1*parseFloat(d3.select(this).attr("height"))/4;else if(a.values[0][d]<0)var i=v(0)+3*parseFloat(d3.select(this).attr("height"))/4;var j=Math.max(u.bandwidth()/3,.02*g,.02*h);A.append("circle").attr("class","tooltip").attr("r",j).attr("cx",f).attr("cy",i).style("fill","aliceblue").style("pointer-events","none").style("stroke","black").style("stroke-width",.002*h+"px").style("stroke-opacity",.8).attr("fill-opacity",.8),A.append("text").attr("class","tooltip").attr("x",f).attr("y",i).attr("dy",Math.min(.4*j,8)+"px").attr("text-anchor","middle").attr("fill","black").style("pointer-events","none").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").text(a.values[0][d]),N("text.tooltip",3*j/2,20,0,3*j/2)}).on("mouseout",function(){d3.selectAll(".tooltip").transition().duration(100).attr("fill-opacity",0).style("stroke-opacity",0).remove()});var B=o.selectAll(".errorbars").data(function(a){return a.values}).enter().append("g").attr("class","errorbars").style("pointer-events","none").attr("transform",function(a){var b=u(a.key)+u.bandwidth()/2;return"translate("+b+", 0 )"});B.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",x).attr("x1",0).attr("y1",p).attr("x2",0).attr("y2",p).transition().duration(500).attr("x1",0).attr("y1",function(a){var b=a.values[0][d]+a.values[0].stderror;return v(b)}).attr("x2",0).attr("y2",function(a){var b=a.values[0][d]-a.values[0].stderror;return v(b)}),B.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",x).attr("x1",-u.bandwidth()/4).attr("y1",p).attr("x2",u.bandwidth()/4).attr("y2",p).transition().duration(500).attr("x1",-u.bandwidth()/4).attr("y1",function(a){var b=a.values[0][d]+a.values[0].stderror;return v(b)}).attr("x2",u.bandwidth()/4).attr("y2",function(a){var b=a.values[0][d]+a.values[0].stderror;return v(b)}).attr("stroke","black").attr("stroke-width",x),B.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",x).attr("x1",-u.bandwidth()/4).attr("y1",p).attr("x2",u.bandwidth()/4).attr("y2",p).transition().duration(500).attr("x1",-u.bandwidth()/4).attr("y1",function(a){var b=a.values[0][d]-a.values[0].stderror;return v(b)}).attr("x2",u.bandwidth()/4).attr("y2",function(a){var b=a.values[0][d]-a.values[0].stderror;return v(b)}).attr("stroke","black").attr("stroke-width",x),A.selectAll(".errorbars line").style("stroke-width",.004*h);var E=A.selectAll(".legend").data(c[0].values).enter().append("g").attr("class","legend").attr("transform",function(a,b){var c=b*L+L;return"translate(0,"+c+")"});E.append("rect").attr("x",g-m.left-M).attr("width",M).attr("height",M).style("fill",function(a){return l(a.key)}),E.append("text").attr("x",.991489*(g-m.left-M)).attr("y",M/2).attr("dy",M/3.2).style("text-anchor","end").text(function(a){return a.key}).classed("legendtext",!0).style("font-family","'Droid Sans', Helvetica, Arial, sans-serif");var O=A.append("g").attr("transform",function(){var a=g-m.left;return"translate("+a+","+L/2+")"}).append("text").text(f).attr("class","legendtitle").attr("x",0).attr("y",0).style("text-anchor","end").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif"),P=A.append("g").attr("class","axiscontrolstitle").attr("transform",function(){var a=g-m.left,b=c[0].values.length*L+3*L;return"translate("+a+","+b+")"});P.append("text").text("X axis controls").attr("class","morphtext3").attr("x",-K/2).attr("y",0).style("fill","steelblue").style("text-anchor","middle").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif");var Q=A.append("g").attr("class","fliptitle").attr("transform",function(){var a=g-m.left,b=c[0].values.length*L+4.7*L;return"translate("+a+","+b+")"});Q.append("text").text("Flips").attr("class","morphtext3").attr("x",-K/2).attr("y",0).style("text-anchor","middle").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif");var R=["Flip "+f,"Flip "+e],S=[e,f],T=A.selectAll(".morphbutton").data(R).enter().append("g").attr("class",function(a,b){return"morphbutton"+b}).attr("transform",function(a,b){var d=g-m.left-K,e=c[0].values.length*L+b*(L+1)+5*L;return"translate("+d+","+e+")"});T.append("rect").attr("width",K).attr("height",L).attr("rx","5").attr("ry","5").style("fill","#C0C0C0").on("mousedown",function(){d3.select(this).style("fill","darkgrey")}).on("mouseout",function(){d3.select(this).style("fill","#C0C0C0")}).on("mouseup",function(){d3.select(this).style("fill","#C0C0C0")}),T.append("text").text(function(a){return a}).classed("morphtext",!0).attr("x",K/2).attr("y",3*L/4).style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").style("text-anchor","middle").style("fill","white").style("pointer-events","none");var U=A.append("g").attr("class","redrawtitle").attr("transform",function(){var a=g-m.left,b=c[0].values.length*L+R.length*(L+1)+6.7*L;return"translate("+a+","+b+")"});U.append("text").text("X axis factor").attr("class","morphtext3").attr("x",-K/2).attr("y",0).style("text-anchor","middle").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif");var V=A.selectAll(".morphbutton_2_").data(S).enter().append("g").attr("class",function(a,b){return"morphbutton_2_"+b}).attr("transform",function(a,b){var d=g-m.left-K,e=c[0].values.length*L+R.length*(L+1)+b*(L+1)+7*L;return"translate("+d+","+e+")"});V.append("rect").attr("width",K).attr("height",L).attr("rx","5").attr("ry","5").style("fill","#C0C0C0").on("mousedown",function(){d3.select(this).style("fill","darkgrey")}).on("mouseout",function(){d3.select(this).style("fill","#C0C0C0")}).on("mouseup",function(){d3.select(this).style("fill","#C0C0C0")}),V.append("text").text(function(a){return a}).classed("morphtext2",!0).attr("x",K/2).attr("y",3*L/4).style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").style("text-anchor","middle").style("fill","white").style("pointer-events","none"),N("text.morphtext",K-5,16,0,L),N("text.morphtext2",K-5,16,0,L),N("text.morphtext3",K-5,16,0,L),N("text.legendtext",m.legend-M,16,0,M),N("text.legendtitle",.9*m.legend,16,0,M),d3.selectAll("text.legendtitle").style("font-weight","bold"),d3.selectAll(".axiscontrolstitle text").style("font-weight","bold"),d3.selectAll(".fliptitle text").style("font-style","italic"),d3.selectAll(".redrawtitle text").style("font-style","italic"),T.filter(function(a,b){return"morphbutton0"==d3.select(this).attr("class")}).style("font-style","italic").on("click",function(){0==F&&(F=1,0==C?(u.rangeRound([t.bandwidth(),0]),C=1):1==C&&(u.rangeRound([0,t.bandwidth()]),C=0),o.selectAll("rect").data(function(a){return a.values}).transition().attr("width",u.bandwidth()).attr("x",function(a){return u(a.key)}).attr("y",function(a){return v(Math.max(0,a.values[0][d]))+.001*h}).attr("height",function(a){return Math.abs(v(a.values[0][d])-v(0))}).style("fill",function(a){return l(a.key)}),o.selectAll(".errorbars").data(function(a){return a.values}).transition().attr("transform",function(a){var b=u(a.key)+u.bandwidth()/2;return"translate("+b+", 0 )"}).call(function(){F=0}))}),T.filter(function(a,b){return"morphbutton1"==d3.select(this).attr("class")}).style("font-style","italic").on("click",function(){0==F&&(F=1,0==D?(t.rangeRound([n,0]).padding(q),D=1):1==D&&(t.rangeRound([0,n]).padding(q),D=0),A.select("g.x.x0.axis").transition().call(y),A.selectAll("g.factor1group").data(c).transition().attr("transform",function(a){return"translate("+t(a.key)+",0)"}),setTimeout(function(){F=0},500))}),V.on("click",function(){"morphbutton_2_0"==d3.select(this).attr("class")&&(H=1,I=e,J=f),"morphbutton_2_1"==d3.select(this).attr("class")&&(H=2,I=f,J=e),0==F&&G!==H&&(F=1,G=H,C=0,D=0,W(I,J))})})}function hibars3(a){function S(a,b,c,d,e){var f=[];E.selectAll(a).style("font-size","1px").each(function(){var a=this.getBBox();null==a.width&&(a.width=10),null==a.height&&(a.height=1);var d=Math.min(b/a.width,c);if(f.push(d),e){var g=Math.min(e/a.height,c);f.push(g)}});var g;g=d?Math.max(d3.min(f),d)+"px":d3.min(f)+"px",E.selectAll(a).style("font-size",g)}var u,z,b="#"+a.location,c=a.datafile,d=a.dependent,e=a.factor1,f=a.factor2,g=a.factor3,h=a.chartwidth||800,l=a.chartheight||500,m=a.colorscheme||colorpalettes.defaultcolors,n=a.auto_size||"no",o={top:.04*l,right:.025*h,bottom:.12*l,left:.09375*h,legend:.15*h},p=h-o.left-o.right-o.legend,r=(h-o.left-o.right,l-o.top-o.bottom),s=.1,t=.1,v=d3.scaleBand().rangeRound([0,p]).padding(s),w=d3.scaleBand(),x=d3.scaleBand(),y=d3.scaleLinear().range([r,0]),A=2,B=d3.axisBottom().scale(v).tickSize(0).tickPadding(2*o.bottom/3),C=d3.axisBottom().tickSize(0).tickPadding(1*o.bottom/5),D=d3.axisLeft().scale(y).tickSizeInner(-p).tickSizeOuter(0).tickPadding(.0125*h);if("no"==n)var E=d3.select(b).style("text-align","center").append("svg").attr("width",p+o.left+o.right+o.legend).attr("height",r+o.top+o.bottom).append("g").attr("transform","translate("+o.left+","+o.top+")");else if("yes"==n)var F=d3.select(b).style("text-align","center").append("div").style("display","inline-block").style("position","relative").style("width","100%").style("padding-bottom","calc(100% * "+l/h+")").style("vertical-align","top").style("overflow","hidden"),E=F.append("svg").attr("viewBox","0 0 "+h+" "+l).attr("preserveAspectRatio","xMinYMin meet").style("display","inline-block").style("position","absolute").style("top","0px").style("left","0px").append("g").attr("transform","translate("+o.left+","+o.top+")");var M,N,O,G=0,H=0,I=0,J=0,K=1,L=1,P=.15*h,Q=.05*r;Q>20&&(Q=20);var R=.9*Math.min(P,Q);d3.csv(c,function(a,b){function da(a,e,f){for(c=d3.nest().key(function(b){return b[a]}).key(function(a){return a[e]}).key(function(a){return a[f]}).entries(b),i=0;i<c.length;i++)for(j=0;j<c[i].values.length;j++)for(k=0;k<c[i].values[j].values.length;k++)c[i].values[j].values[k].values[0].stderror=+c[i].values[j].values[k].values[0].stderror,c[i].values[j].values[k].values[0][d]=+c[i].values[j].values[k].values[0][d];v.domain(c.map(function(a){return a.key})).rangeRound([0,p]).padding(s),w.domain(c[0].values.map(function(a){return a.key})).rangeRound([0,v.bandwidth()]).padding(t),x.domain(c[0].values[0].values.map(function(a){return a.key})).rangeRound([0,w.bandwidth()]),u=c[0].values[0].values.length,z.domain(c[0].values[0].values.map(function(a){return a.key})),z.range(function(){return m[u]||colorpalettes.defaultcolors[u]}()),E.selectAll(".databar").transition().duration(500).attr("y",1e3).transition().remove(),E.selectAll(".errorline").transition().duration(500).attr("y1",1e3).attr("y2",1e3).transition().remove(),setTimeout(function(){B.scale(v),C.scale(w),E.select(".x.axis").call(B),n=n.data([]).exit().remove(),q=q.data([]).exit().remove(),n=E.selectAll(".factor1group").data(c).enter().append("g").attr("class","factor1group").attr("transform",function(a){return"translate("+v(a.key)+",0)"}),n.append("g").attr("class","x1 axis").attr("transform","translate(0,"+r+")").call(C).style("font-size","12px"),q=E.selectAll(".axisticks1").data(c).enter().append("g").attr("class","axisticks1").attr("transform",function(a){return"translate("+v(a.key)+",0)"}),q.filter(function(a,b){return b<c.length-1}).append("line").attr("class","group1tick").attr("x1",v.bandwidth()/2+v.bandwidth()/(2-2*s)).attr("y1",r).attr("x2",v.bandwidth()/2+v.bandwidth()/(2-2*s)).attr("y2",r+o.bottom).attr("stroke","black").attr("stroke-width",.002*l),F=n.selectAll(".factor2group").data(function(a){return a.values}).enter().append("g").attr("class","factor2group").attr("transform",function(a){return"translate("+w(a.key)+",0)"}),T=q.selectAll(".axisticks2").data(function(a){return a.values}).enter().append("g").attr("class","axisticks2").attr("transform",function(a){return"translate("+w(a.key)+",0)"}),T.filter(function(a,b){return b<c[0].values.length-1}).append("line").attr("class","group2tick").attr("x1",w.bandwidth()/2+w.bandwidth()/(2-2*t)).attr("y1",r).attr("x2",w.bandwidth()/2+w.bandwidth()/(2-2*t)).attr("y2",r+o.bottom/3).attr("stroke","black").attr("stroke-width",.002*l),S(".x0.axis text",v.bandwidth(),.02*h,0,.032*l),S(".x1.axis text",w.bandwidth(),.015*h,0,.024*l),E.select("g.x.x0.axis").call(B),n.call(C),E.selectAll(".axis path").attr("stroke-width",.002*l),E.selectAll("g.x1").selectAll("path").attr("display","none"),U=F.selectAll("rect").data(function(a){return a.values}).enter().append("rect").attr("class","databar").attr("width",x.bandwidth()).attr("height",function(a){return Math.abs(y(a.values[0][d])-y(0))}).style("fill",function(a){return z(a.key)}).attr("x",function(a){return x(a.key)}).attr("y",r).transition().duration(500).attr("y",function(a){return a.values[0][d]>=0?y(a.values[0][d])+50/l:a.values[0][d]<0?y(0)+1-50/l:void 0}),F.selectAll("rect").on("mouseover",function(a){var b=d3.select(this.parentNode).attr("transform"),c=b.substring(b.indexOf("(")+1,b.indexOf(")")).split(","),e=Number(c[0]),f=d3.select(this.parentNode.parentNode).attr("transform"),g=f.substring(f.indexOf("(")+1,f.indexOf(")")).split(","),i=Number(g[0]),j=parseFloat(d3.select(this).attr("x"))+e+i+x.bandwidth()/2;if(a.values[0][d]>=0)var k=parseFloat(d3.select(this).attr("y"))+1*parseFloat(d3.select(this).attr("height"))/4;else if(a.values[0][d]<0)var k=y(0)+3*parseFloat(d3.select(this).attr("height"))/4;var m=Math.max(x.bandwidth()/3,.02*h,.02*l);E.append("circle").attr("class","tooltip").attr("r",m).attr("cx",j).attr("cy",k).style("fill","aliceblue").style("pointer-events","none").style("stroke","black").style("stroke-width",.002*l+"px").style("stroke-opacity",.8).attr("fill-opacity",.8),E.append("text").attr("class","tooltip").attr("x",j).attr("y",k).attr("dy",Math.min(.4*m,8)+"px").attr("text-anchor","middle").attr("fill","black").style("pointer-events","none").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").text(a.values[0][d]),S("text.tooltip",3*m/2,20,0,3*m/2)}).on("mouseout",function(){d3.selectAll(".tooltip").transition().duration(100).attr("fill-opacity",0).style("stroke-opacity",0).remove()}),V=F.selectAll(".errorbars").data(function(a){return a.values}).enter().append("g").attr("class","errorbars").style("pointer-events","none").attr("transform",function(a){var b=x(a.key)+x.bandwidth()/2;return"translate("+b+", 0 )"}),V.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",A).attr("x1",0).attr("y1",r).attr("x2",0).attr("y2",r).transition().duration(500).attr("x1",0).attr("y1",function(a){var b=a.values[0][d]+a.values[0].stderror;return y(b)}).attr("x2",0).attr("y2",function(a){var b=a.values[0][d]-a.values[0].stderror;return y(b)}),V.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",A).attr("x1",-x.bandwidth()/4).attr("y1",r).attr("x2",x.bandwidth()/4).attr("y2",r).transition().duration(500).attr("x1",-x.bandwidth()/4).attr("y1",function(a){var b=a.values[0][d]+a.values[0].stderror;return y(b)}).attr("x2",x.bandwidth()/4).attr("y2",function(a){var b=a.values[0][d]+a.values[0].stderror;return y(b)}).attr("stroke","black").attr("stroke-width",A),V.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",A).attr("x1",-x.bandwidth()/4).attr("y1",r).attr("x2",x.bandwidth()/4).attr("y2",r).transition().duration(500).attr("x1",-x.bandwidth()/4).attr("y1",function(a){var b=a.values[0][d]-a.values[0].stderror;return y(b)}).attr("x2",x.bandwidth()/4).attr("y2",function(a){var b=a.values[0][d]-a.values[0].stderror;return y(b)}).attr("stroke","black").attr("stroke-width",A),W.data([]).exit().remove(),W=E.selectAll(".legend").data(c[0].values[0].values).enter().append("g").attr("class","legend").attr("transform",function(a,b){var c=b*R*1.1+R;return"translate(0,"+c+")"}),W.append("rect").attr("x",h-o.left-R).attr("width",R).attr("height",R).style("fill",function(a){return z(a.key)}),W.append("text").attr("x",.991489*(h-o.left-R)).attr("y",R/2).attr("dy",R/3.2).style("text-anchor","end").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").text(function(a){return a.key}).classed("legendtext",!0).style("font-size","1px").style("font-size",function(a){var b=this.getBBox(),e=(b.width,b.height,Math.min(P/(b.width+2),Q/b.height,16));return e+"px"}),S(".legendtext",o.legend-R,16,0,R),X.text(f),Y.transition().attr("transform",function(){var a=h-o.left,b=c[0].values[0].values.length*R*1.1+3*Q;return"translate("+a+","+b+")"}),Z.transition().attr("transform",function(){var a=h-o.left,b=c[0].values[0].values.length*R*1.1+4.7*Q;return"translate("+a+","+b+")"}),aa.transition().attr("transform",function(a,b){var d=h-o.left-P,e=c[0].values[0].values.length*R*1.1+b*(Q+1)+5*Q;return"translate("+d+","+e+")"}),ba.transition().attr("transform",function(){var a=h-o.left,b=c[0].values[0].values.length*R*1.1+$.length*(Q+1)+6.7*Q;return"translate("+a+","+b+")"}),ca.transition().attr("transform",function(a,b){var d=h-o.left-P,e=c[0].values[0].values.length*R*1.1+$.length*(Q+1)+b*(Q+1)+7*Q;return"translate("+d+","+e+")"}),aa.filter(function(a,b){return"morphbutton0"==d3.select(this).attr("class")}).selectAll("text").text("Flip "+f),aa.filter(function(a,b){return"morphbutton1"==d3.select(this).attr("class")}).selectAll("text").text("Flip "+e),aa.filter(function(a,b){return"morphbutton2"==d3.select(this).attr("class")}).selectAll("text").text("Flip "+a),J=0},500)}if(a)throw a;var c=d3.nest().key(function(a){return a[e]}).key(function(a){return a[f]}).key(function(a){return a[g]}).entries(b);for(i=0;i<c.length;i++)for(j=0;j<c[i].values.length;j++)for(k=0;k<c[i].values[j].values.length;k++)c[i].values[j].values[k].values[0].stderror=+c[i].values[j].values[k].values[0].stderror,c[i].values[j].values[k].values[0][d]=+c[i].values[j].values[k].values[0][d];v.domain(c.map(function(a){return a.key})),w.domain(c[0].values.map(function(a){return a.key})).rangeRound([0,v.bandwidth()]).padding(t),x.domain(c[0].values[0].values.map(function(a){return a.key})).rangeRound([0,w.bandwidth()]),C.scale(w),u=c[0].values[0].values.length,Q=Math.min(.05*r,(r-c[0].values[0].values[0].values.length*R*1.1)/16,(r-c[0].values[0].values.length*R*1.1)/16,(r-c[0].values.length*R*1.1)/16,20),z=d3.scaleOrdinal().range(function(){return m[u]||colorpalettes.defaultcolors[u]}()),y.domain([Math.min(0,d3.min(c,function(a){return d3.min(a.values,function(a){return d3.min(a.values,function(a){return d3.min(a.values,function(a){return a[d]-a.stderror})})})})),Math.max(0,d3.max(c,function(a){return d3.max(a.values,function(a){return d3.max(a.values,function(a){return d3.max(a.values,function(a){return a[d]+a.stderror})})})}))]).nice(),E.append("g").attr("class","x x0 axis").attr("transform","translate(0,"+r+")").call(B),E.append("g").attr("class","y axis").call(D.tickFormat(d3.format(".0s"))),E.append("text").attr("transform","rotate(-90)").attr("x",-r/2).attr("y",-(o.left-.00625*h)).attr("dy",.25*o.left).style("text-anchor","middle").style("font-size","1px").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").text(d).style("font-size",function(a){var b=this.getBBox(),e=(b.width,b.height,Math.min(r/(b.width+1),p/(b.height+1),20,.04*l,.04*h));return e+"px"});var n=E.selectAll(".factor1group").data(c).enter().append("g").attr("class","factor1group").attr("transform",function(a){return"translate("+v(a.key)+",0)"});n.append("g").attr("class","x1 axis").attr("transform","translate(0,"+r+")").call(C).style("font-size","12px");var q=E.selectAll(".axisticks1").data(c).enter().append("g").attr("class","axisticks1").attr("transform",function(a){return"translate("+v(a.key)+",0)"});q.filter(function(a,b){return b<c.length-1}).append("line").attr("class","group1tick").attr("x1",v.bandwidth()/2+v.bandwidth()/(2-2*s)).attr("y1",r).attr("x2",v.bandwidth()/2+v.bandwidth()/(2-2*s)).attr("y2",r+o.bottom).attr("stroke","black").attr("stroke-width",.002*l);var F=n.selectAll(".factor2group").data(function(a){return a.values}).enter().append("g").attr("class","factor2group").attr("transform",function(a){return"translate("+w(a.key)+",0)"}),T=q.selectAll(".axisticks2").data(function(a){return a.values}).enter().append("g").attr("class","axisticks2").attr("transform",function(a){return"translate("+w(a.key)+",0)"});T.filter(function(a,b){return b<c[0].values.length-1}).append("line").attr("class","group2tick").attr("x1",w.bandwidth()/2+w.bandwidth()/(2-2*t)).attr("y1",r).attr("x2",w.bandwidth()/2+w.bandwidth()/(2-2*t)).attr("y2",r+o.bottom/3).attr("stroke","black").attr("stroke-width",.002*l),S(".x0.axis text",v.bandwidth(),.02*h,0,.032*l),S(".x1.axis text",w.bandwidth(),.015*h,0,.024*l),E.select("g.x.x0.axis").call(B),n.call(C),E.selectAll("g.tick").filter(function(a){return 0!=a}).select("line").style("opacity","0.2"),E.selectAll("g.tick").select("line").attr("stroke-width",.002*l),E.selectAll(".axis path").attr("stroke-width",.002*l),E.selectAll("g.x1").selectAll("path").attr("display","none"),E.selectAll(".y.axis").style("font-size",function(){return Math.min(.032*l,.032*h,16)+"px"});var U=F.selectAll("rect").data(function(a){
return a.values}).enter().append("rect").attr("class","databar").attr("width",x.bandwidth()).attr("height",function(a){return Math.abs(y(a.values[0][d])-y(0))}).style("fill",function(a){return z(a.key)}).attr("x",function(a){return x(a.key)}).attr("y",r).transition().duration(500).attr("y",function(a){return a.values[0][d]>=0?y(a.values[0][d])+50/l:a.values[0][d]<0?y(0)+1-50/l:void 0});F.selectAll("rect").on("mouseover",function(a){var b=d3.select(this.parentNode).attr("transform"),c=b.substring(b.indexOf("(")+1,b.indexOf(")")).split(","),e=Number(c[0]),f=d3.select(this.parentNode.parentNode).attr("transform"),g=f.substring(f.indexOf("(")+1,f.indexOf(")")).split(","),i=Number(g[0]),j=parseFloat(d3.select(this).attr("x"))+e+i+x.bandwidth()/2;if(a.values[0][d]>=0)var k=parseFloat(d3.select(this).attr("y"))+1*parseFloat(d3.select(this).attr("height"))/4;else if(a.values[0][d]<0)var k=y(0)+3*parseFloat(d3.select(this).attr("height"))/4;var m=Math.max(x.bandwidth()/3,.02*h,.02*l);E.append("circle").attr("class","tooltip").attr("r",m).attr("cx",j).attr("cy",k).style("fill","aliceblue").style("pointer-events","none").style("stroke","black").style("stroke-width",.002*l+"px").style("stroke-opacity",.8).attr("fill-opacity",.8),E.append("text").attr("class","tooltip").attr("x",j).attr("y",k).attr("dy",Math.min(.4*m,8)+"px").attr("text-anchor","middle").attr("fill","black").style("pointer-events","none").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").text(a.values[0][d]),S("text.tooltip",3*m/2,20,0,3*m/2)}).on("mouseout",function(){d3.selectAll(".tooltip").transition().duration(100).attr("fill-opacity",0).style("stroke-opacity",0).remove()});var V=F.selectAll(".errorbars").data(function(a){return a.values}).enter().append("g").attr("class","errorbars").style("pointer-events","none").attr("transform",function(a){var b=x(a.key)+x.bandwidth()/2;return"translate("+b+", 0 )"});V.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",A).attr("x1",0).attr("y1",r).attr("x2",0).attr("y2",r).transition().duration(500).attr("x1",0).attr("y1",function(a){var b=a.values[0][d]+a.values[0].stderror;return y(b)}).attr("x2",0).attr("y2",function(a){var b=a.values[0][d]-a.values[0].stderror;return y(b)}),V.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",A).attr("x1",-x.bandwidth()/4).attr("y1",r).attr("x2",x.bandwidth()/4).attr("y2",r).transition().duration(500).attr("x1",-x.bandwidth()/4).attr("y1",function(a){var b=a.values[0][d]+a.values[0].stderror;return y(b)}).attr("x2",x.bandwidth()/4).attr("y2",function(a){var b=a.values[0][d]+a.values[0].stderror;return y(b)}).attr("stroke","black").attr("stroke-width",A),V.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",A).attr("x1",-x.bandwidth()/4).attr("y1",r).attr("x2",x.bandwidth()/4).attr("y2",r).transition().duration(500).attr("x1",-x.bandwidth()/4).attr("y1",function(a){var b=a.values[0][d]-a.values[0].stderror;return y(b)}).attr("x2",x.bandwidth()/4).attr("y2",function(a){var b=a.values[0][d]-a.values[0].stderror;return y(b)}).attr("stroke","black").attr("stroke-width",A);var W=E.selectAll(".legend").data(c[0].values[0].values).enter().append("g").attr("class","legend").attr("transform",function(a,b){var c=b*R*1.1+R;return"translate(0,"+c+")"});W.append("rect").attr("x",h-o.left-R).attr("width",R).attr("height",R).style("fill",function(a){return z(a.key)}),W.append("text").attr("x",.991489*(h-o.left-R)).attr("y",R/2).attr("dy",R/3.2).style("text-anchor","end").text(function(a){return a.key}).style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").classed("legendtext",!0);var X=E.append("g").attr("transform",function(){var a=h-o.left;return"translate("+a+","+R/2+")"}).append("text").attr("class","legendtitle").text(g).attr("x",0).attr("y",0).style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").style("text-anchor","end"),Y=E.append("g").attr("class","axiscontrolstitle").attr("transform",function(){var a=h-o.left,b=c[0].values[0].values.length*R*1.1+3*Q;return"translate("+a+","+b+")"});Y.append("text").text("X axis controls").classed("morphtext3",!0).attr("x",-P/2).attr("y",0).style("fill","steelblue").style("text-anchor","middle").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif");var Z=E.append("g").attr("class","fliptitle").attr("transform",function(){var a=h-o.left,b=c[0].values[0].values.length*R*1.1+4.7*Q;return"translate("+a+","+b+")"});Z.append("text").text("Flips").classed("morphtext3",!0).attr("x",-P/2).attr("y",0).style("text-anchor","middle").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif");var $=["Flip "+g,"Flip "+f,"Flip "+e],_=[e+","+f,e+","+g,f+","+e,g+","+e,f+","+g,g+","+f],aa=E.selectAll(".morphbutton").data($).enter().append("g").attr("class",function(a,b){return"morphbutton"+b}).attr("transform",function(a,b){var d=h-o.left-P,e=c[0].values[0].values.length*R*1.1+b*(Q+1)+5*Q;return"translate("+d+","+e+")"});aa.append("rect").attr("width",P).attr("height",Q).attr("rx","5").attr("ry","5").style("fill","#C0C0C0").on("mousedown",function(){d3.select(this).style("fill","darkgrey")}).on("mouseout",function(){d3.select(this).style("fill","#C0C0C0")}).on("mouseup",function(){d3.select(this).style("fill","#C0C0C0")}),aa.append("text").text(function(a){return a}).classed("morphtext",!0).attr("x",P/2).attr("y",3*Q/4).style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").style("text-anchor","middle").style("fill","white").style("pointer-events","none");var ba=E.append("g").attr("class","redrawtitle").attr("transform",function(){var a=h-o.left,b=c[0].values[0].values.length*R*1.1+$.length*(Q+1)+6.7*Q;return"translate("+a+","+b+")"});ba.append("text").text("X axis factor").classed("morphtext3",!0).attr("x",-P/2).attr("y",0).style("text-anchor","middle").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif");var ca=E.selectAll(".morphbutton_2_").data(_).enter().append("g").attr("class",function(a,b){return"morphbutton_2_"+b}).attr("transform",function(a,b){var d=h-o.left-P,e=c[0].values[0].values.length*R*1.1+$.length*(Q+1)+b*(Q+1)+7*Q;return"translate("+d+","+e+")"});ca.append("rect").attr("width",P).attr("height",Q).attr("rx","5").attr("ry","5").style("fill","#C0C0C0").on("mousedown",function(){d3.select(this).style("fill","darkgrey")}).on("mouseout",function(){d3.select(this).style("fill","#C0C0C0")}).on("mouseup",function(){d3.select(this).style("fill","#C0C0C0")}),ca.append("text").text(function(a){return a}).classed("morphtext2",!0).attr("x",P/2).attr("y",3*Q/4).style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").style("text-anchor","middle").style("fill","white").style("pointer-events","none"),S("text.morphtext",P-5,16,0,Q),S("text.morphtext2",P-5,16,0,Q),S("text.morphtext3",P-5,16,0,Q),S("text.legendtext",o.legend-R,16,0,R),S("text.legendtitle",.9*o.legend,16,0,R),d3.selectAll("text.legendtitle").style("font-weight","bold"),d3.selectAll(".axiscontrolstitle text").style("font-weight","bold"),d3.selectAll(".fliptitle text").style("font-style","italic"),d3.selectAll(".redrawtitle text").style("font-style","italic"),aa.filter(function(a,b){return"morphbutton0"==d3.select(this).attr("class")}).style("font-style","italic").on("click",function(){0==J&&(J=1,0==G?(x.rangeRound([w.bandwidth(),0]),G=1):1==G&&(x.rangeRound([0,w.bandwidth()]),G=0),F.selectAll("rect").data(function(a){return a.values}).transition().attr("width",x.bandwidth()).attr("x",function(a){return x(a.key)}).attr("y",function(a){return y(Math.max(0,a.values[0][d]))+.001*l}).attr("height",function(a){return Math.abs(y(a.values[0][d])-y(0))}).style("fill",function(a){return z(a.key)}),F.selectAll(".errorbars").data(function(a){return a.values}).transition().attr("transform",function(a){var b=x(a.key)+x.bandwidth()/2;return"translate("+b+", 0 )"}).call(function(){J=0}))}),aa.filter(function(a,b){return"morphbutton1"==d3.select(this).attr("class")}).style("font-style","italic").on("click",function(){0==J&&(J=1,0==H?(w.rangeRound([v.bandwidth(),0]).padding(t),H=1):1==H&&(w.rangeRound([0,v.bandwidth()]).padding(t),H=0),n.selectAll(".x1.axis").transition().call(C),n.selectAll("g.factor2group").data(function(a){return a.values}).transition().attr("transform",function(a){return"translate("+w(a.key)+",0)"}),setTimeout(function(){J=0},500))}),aa.filter(function(a,b){return"morphbutton2"==d3.select(this).attr("class")}).style("font-style","italic").on("click",function(){0==J&&(J=1,0==I?(v.rangeRound([p,0]).padding(s),I=1):1==I&&(v.rangeRound([0,p]).padding(s),I=0),E.select("g.x.x0.axis").transition().call(B),E.selectAll("g.factor1group").data(c).transition().attr("transform",function(a){return"translate("+v(a.key)+",0)"}),setTimeout(function(){J=0},500))}),ca.on("click",function(){"morphbutton_2_0"==d3.select(this).attr("class")&&(L=1,M=e,N=f,O=g),"morphbutton_2_1"==d3.select(this).attr("class")&&(L=2,M=e,N=g,O=f),"morphbutton_2_2"==d3.select(this).attr("class")&&(L=3,M=f,N=e,O=g),"morphbutton_2_3"==d3.select(this).attr("class")&&(L=4,M=g,N=e,O=f),"morphbutton_2_4"==d3.select(this).attr("class")&&(L=5,M=f,N=g,O=e),"morphbutton_2_5"==d3.select(this).attr("class")&&(L=6,M=g,N=f,O=e),0==J&&K!==L&&(J=1,K=L,G=0,H=0,I=0,da(M,N,O))})})}function hibars4(a){function Z(a,b,c,d,e){var f=[];J.selectAll(a).style("font-size","1px").each(function(){var a=this.getBBox();null==a.width&&(a.width=10),null==a.height&&(a.height=1);var d=Math.min(b/a.width,c);if(f.push(d),e){var g=Math.min(e/a.height,c);f.push(g)}});var g;g=d?Math.max(d3.min(f),d)+"px":d3.min(f)+"px",J.selectAll(a).style("font-size",g)}var x,D,b="#"+a.location,c=a.datafile,d=a.dependent,e=a.factor1,f=a.factor2,g=a.factor3,h=a.factor4,m=a.chartwidth||800,n=a.chartheight||500,o=a.colorscheme||colorpalettes.defaultcolors,p=a.auto_size||"no",q={top:.04*n,right:.025*m,bottom:.12*n,left:.09375*m,legend:.15*m},r=m-q.left-q.right-q.legend,t=(m-q.left-q.right,n-q.top-q.bottom),u=.05,v=.1,w=.1,y=d3.scaleBand().rangeRound([0,r]).padding(u),z=d3.scaleBand(),A=d3.scaleBand(),B=d3.scaleBand(),C=d3.scaleLinear().range([t,0]),E=2,F=d3.axisBottom().scale(y).tickSizeInner(0).tickSizeOuter(0).tickPadding(3*q.bottom/5),G=d3.axisBottom().tickSizeInner(0).tickSizeOuter(0).tickPadding(1*q.bottom/3),H=d3.axisBottom().tickSizeInner(0).tickSizeOuter(0).tickPadding(1*q.bottom/8),I=d3.axisLeft().scale(C).tickSizeInner(-r).tickSizeOuter(0).tickPadding(.0125*m);if("no"==p)var J=d3.select(b).style("text-align","center").append("svg").attr("width",r+q.left+q.right+q.legend).attr("height",t+q.top+q.bottom).append("g").attr("transform","translate("+q.left+","+q.top+")");else if("yes"==p)var K=d3.select(b).style("text-align","center").append("div").style("display","inline-block").style("position","relative").style("width","100%").style("padding-bottom","calc(100% * "+n/m+")").style("vertical-align","top").style("overflow","hidden"),J=K.append("svg").attr("viewBox","0 0 "+m+" "+n).attr("preserveAspectRatio","xMinYMin meet").style("display","inline-block").style("position","absolute").style("top","0px").style("left","0px").append("g").attr("transform","translate("+q.left+","+q.top+")");var L=0,M=0,N=0,O=0,P=0,W=.15*m,X=.05*t;X>20&&(X=20);var Y=.9*Math.min(W,X);d3.csv(c,function(a,c){function ha(){var a=d3.event.target.value,b=a.split(",");0==P&&(P=1,L=0,M=0,N=0,O=0,ia(b[0],b[1],b[2],b[3]))}function ia(a,b,e,f){for(p=d3.nest().key(function(b){return b[a]}).key(function(a){return a[b]}).key(function(a){return a[e]}).key(function(a){return a[f]}).entries(c),i=0;i<p.length;i++)for(j=0;j<p[i].values.length;j++)for(k=0;k<p[i].values[j].values.length;k++)for(l=0;l<p[i].values[j].values[k].values.length;l++)p[i].values[j].values[k].values[l].values[0].stderror=+p[i].values[j].values[k].values[l].values[0].stderror,p[i].values[j].values[k].values[l].values[0][d]=+p[i].values[j].values[k].values[l].values[0][d];y.domain(p.map(function(a){return a.key})).rangeRound([0,r]).padding(u),z.domain(p[0].values.map(function(a){return a.key})).rangeRound([0,y.bandwidth()]).padding(v),A.domain(p[0].values[0].values.map(function(a){return a.key})).rangeRound([0,z.bandwidth()]).padding(w),B.domain(p[0].values[0].values[0].values.map(function(a){return a.key})).rangeRound([0,A.bandwidth()]),x=p[0].values[0].values[0].values.length,D.range(function(){return o[x]||colorpalettes.defaultcolors[x]}()),D.domain(p[0].values[0].values[0].values.map(function(a){return a.key})),J.selectAll(".databar").transition().duration(500).attr("y",1e3).transition().remove(),J.selectAll(".errorline").transition().duration(500).attr("y1",1e3).attr("y2",1e3).transition().remove(),setTimeout(function(){F.scale(y),G.scale(z),H.scale(A),J.select(".x.axis").call(F),s=s.data([]).exit().remove(),K=K.data([]).exit().remove(),s=J.selectAll(".factor1group").data(p).enter().append("g").attr("class","factor1group").attr("transform",function(a){return"translate("+y(a.key)+",0)"}),s.append("g").attr("class","x1 axis").attr("transform","translate(0,"+t+")").call(G).style("font-size","12px"),K=J.selectAll(".axisticks1").data(p).enter().append("g").attr("class","axisticks1").attr("transform",function(a){return"translate("+y(a.key)+",0)"}),K.filter(function(a,b){return b<p.length-1}).append("line").attr("class","group1tick").attr("x1",y.bandwidth()/2+y.bandwidth()/(2-2*u)).attr("y1",t).attr("x2",y.bandwidth()/2+y.bandwidth()/(2-2*u)).attr("y2",t+q.bottom).attr("stroke","black").attr("stroke-width",.002*n),Q=s.selectAll(".factor2group").data(function(a){return a.values}).enter().append("g").attr("class","factor2group").attr("transform",function(a){return"translate("+z(a.key)+",0)"}),R=K.selectAll(".axisticks2").data(function(a){return a.values}).enter().append("g").attr("class","axisticks2").attr("transform",function(a){return"translate("+z(a.key)+",0)"}),R.filter(function(a,b){return b<p[0].values.length-1}).append("line").attr("class","group2tick").attr("x1",z.bandwidth()/2+z.bandwidth()/(2-2*v)).attr("y1",t).attr("x2",z.bandwidth()/2+z.bandwidth()/(2-2*v)).attr("y2",t+q.bottom/3).attr("stroke","black").attr("stroke-width",.002*n),S=Q.selectAll(".factor3group").data(function(a){return a.values}).enter().append("g").attr("class","factor3group").attr("transform",function(a){return"translate("+A(a.key)+",0)"}),T=R.selectAll(".axisticks3").data(function(a){return a.values}).enter().append("g").attr("class","axisticks3").attr("transform",function(a){return"translate("+A(a.key)+",0)"}),T.filter(function(a,b){return b<p[0].values[0].values.length-1}).append("line").attr("class","group3tick").attr("x1",A.bandwidth()/2+A.bandwidth()/(2-2*w)).attr("y1",t).attr("x2",A.bandwidth()/2+A.bandwidth()/(2-2*w)).attr("y2",t+q.bottom/5).attr("stroke","black").attr("stroke-width",.002*n),Z(".x0.axis text",y.bandwidth(),.02*m,0,.032*n),Z(".x1.axis text",z.bandwidth(),.015*m,0,.024*n),Z(".x2.axis text",A.bandwidth(),.0125*m,0,.02*n),J.select("g.x.x0.axis").call(F),s.call(G),Q.append("g").attr("class","x2 axis").attr("transform","translate(0,"+t+")").call(H).style("font-size","10px").selectAll("text").style("text-anchor","middle"),Z(".x2.axis text",A.bandwidth(),.0125*m,0,.02*n),Q.call(H),J.selectAll(".axis path").attr("stroke-width",.002*n),J.selectAll("g.x1, g.x2").selectAll("path").attr("display","none"),U=S.selectAll("rect").data(function(a){return a.values}).enter().append("rect").attr("class","databar").attr("width",B.bandwidth()).attr("height",function(a){return Math.abs(C(a.values[0][d])-C(0))}).style("fill",function(a){return D(a.key)}).attr("x",function(a){return B(a.key)}).attr("y",t).transition().duration(500).attr("y",function(a){return a.values[0][d]>=0?C(a.values[0][d])+50/n:a.values[0][d]<0?C(0)+1-50/n:void 0}),S.selectAll("rect").on("mouseover",function(a){var b=d3.select(this.parentNode).attr("transform"),c=b.substring(b.indexOf("(")+1,b.indexOf(")")).split(","),e=Number(c[0]),f=d3.select(this.parentNode.parentNode).attr("transform"),g=f.substring(f.indexOf("(")+1,f.indexOf(")")).split(","),h=Number(g[0]),i=d3.select(this.parentNode.parentNode.parentNode).attr("transform"),j=i.substring(i.indexOf("(")+1,i.indexOf(")")).split(","),k=Number(j[0]),l=parseFloat(d3.select(this).attr("x"))+e+h+k+B.bandwidth()/2;if(a.values[0][d]>=0)var o=parseFloat(d3.select(this).attr("y"))+1*parseFloat(d3.select(this).attr("height"))/4;else if(a.values[0][d]<0)var o=C(0)+3*parseFloat(d3.select(this).attr("height"))/4;var p=Math.max(B.bandwidth()/3,.02*m,.02*n);J.append("circle").attr("class","tooltip").attr("r",p).attr("cx",l).attr("cy",o).style("fill","aliceblue").style("pointer-events","none").style("stroke","black").style("stroke-width",.002*n+"px").style("stroke-opacity",.8).attr("fill-opacity",.8),J.append("text").attr("class","tooltip").attr("x",l).attr("y",o).attr("dy",Math.min(.4*p,8)+"px").attr("text-anchor","middle").attr("fill","black").style("pointer-events","none").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").text(a.values[0][d]),Z("text.tooltip",3*p/2,20,0,3*p/2)}).on("mouseout",function(){d3.selectAll(".tooltip").transition().duration(100).attr("fill-opacity",0).style("stroke-opacity",0).remove()}),V=S.selectAll(".errorbars").data(function(a){return a.values}).enter().append("g").attr("class","errorbars").style("pointer-events","none").attr("transform",function(a){var b=B(a.key)+B.bandwidth()/2;return"translate("+b+", 0 )"}),V.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",E).attr("x1",0).attr("y1",t).attr("x2",0).attr("y2",t).transition().duration(500).attr("x1",0).attr("y1",function(a){var b=a.values[0][d]+a.values[0].stderror;return C(b)}).attr("x2",0).attr("y2",function(a){var b=a.values[0][d]-a.values[0].stderror;return C(b)}),V.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",E).attr("x1",-B.bandwidth()/4).attr("y1",t).attr("x2",B.bandwidth()/4).attr("y2",t).transition().duration(500).attr("x1",-B.bandwidth()/4).attr("y1",function(a){var b=a.values[0][d]+a.values[0].stderror;return C(b)}).attr("x2",B.bandwidth()/4).attr("y2",function(a){var b=a.values[0][d]+a.values[0].stderror;return C(b)}).attr("stroke","black").attr("stroke-width",E),V.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",E).attr("x1",-B.bandwidth()/4).attr("y1",t).attr("x2",B.bandwidth()/4).attr("y2",t).transition().duration(500).attr("x1",-B.bandwidth()/4).attr("y1",function(a){var b=a.values[0][d]-a.values[0].stderror;return C(b)}).attr("x2",B.bandwidth()/4).attr("y2",function(a){var b=a.values[0][d]-a.values[0].stderror;return C(b)}).attr("stroke","black").attr("stroke-width",E),$.data([]).exit().remove(),$=J.selectAll(".legend").data(p[0].values[0].values[0].values).enter().append("g").attr("class","legend").attr("transform",function(a,b){var c=b*X+X;return"translate(0,"+c+")"}),$.append("rect").attr("x",m-q.left-Y).attr("width",Y).attr("height",Y).style("fill",function(a){return D(a.key)}),$.append("text").attr("x",.991489*(m-q.left-Y)).attr("y",Y/2).attr("dy",Y/3.2).style("text-anchor","end").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").text(function(a){return a.key}).classed("legendtext",!0).style("font-size","1px").style("font-size",function(a){var b=this.getBBox(),e=(b.width,b.height,Math.min(W/(b.width+2),X/b.height,16));return e+"px"}),Z(".legendtext",q.legend-Y,16,0,Y),_.text(f),aa.transition().attr("transform",function(){var a=m-q.left,b=p[0].values[0].values[0].values.length*X+4.7*X;return"translate("+a+","+b+")"}),da.transition().attr("transform",function(a,b){var c=m-q.left-W,d=p[0].values[0].values[0].values.length*X+b*(X+1)+5*X;return"translate("+c+","+d+")"}),da.filter(function(a,b){return"morphbutton0"==d3.select(this).attr("class")}).selectAll("text").text("Flip "+f),da.filter(function(a,b){return"morphbutton1"==d3.select(this).attr("class")}).selectAll("text").text("Flip "+e),da.filter(function(a,b){return"morphbutton2"==d3.select(this).attr("class")}).selectAll("text").text("Flip "+b),da.filter(function(a,b){return"morphbutton3"==d3.select(this).attr("class")}).selectAll("text").text("Flip "+a),P=0},500)}if(a)throw a;var p=d3.nest().key(function(a){return a[e]}).key(function(a){return a[f]}).key(function(a){return a[g]}).key(function(a){return a[h]}).entries(c);for(i=0;i<p.length;i++)for(j=0;j<p[i].values.length;j++)for(k=0;k<p[i].values[j].values.length;k++)for(l=0;l<p[i].values[j].values[k].values.length;l++)p[i].values[j].values[k].values[l].values[0].stderror=+p[i].values[j].values[k].values[l].values[0].stderror,p[i].values[j].values[k].values[l].values[0][d]=+p[i].values[j].values[k].values[l].values[0][d];y.domain(p.map(function(a){return a.key})),z.domain(p[0].values.map(function(a){return a.key})).rangeRound([0,y.bandwidth()]).padding(v),A.domain(p[0].values[0].values.map(function(a){return a.key})).rangeRound([0,z.bandwidth()]).padding(w),B.domain(p[0].values[0].values[0].values.map(function(a){return a.key})).rangeRound([0,A.bandwidth()]),G.scale(z),H.scale(A),x=p[0].values[0].values[0].values.length,D=d3.scaleOrdinal().range(function(){return o[x]||colorpalettes.defaultcolors[x]}()),C.domain([Math.min(0,d3.min(p,function(a){return d3.min(a.values,function(a){return d3.min(a.values,function(a){return d3.min(a.values,function(a){return d3.min(a.values,function(a){return a[d]-a.stderror})})})})})),Math.max(0,d3.max(p,function(a){return d3.max(a.values,function(a){return d3.max(a.values,function(a){return d3.max(a.values,function(a){return d3.max(a.values,function(a){return a[d]+a.stderror})})})})}))]).nice(),J.append("g").attr("class","x x0 axis").attr("transform","translate(0,"+t+")").call(F),J.append("g").attr("class","y axis").call(I.tickFormat(d3.format(".0s"))),J.append("text").attr("transform","rotate(-90)").attr("x",-t/2).attr("y",-(q.left-.00625*m)).attr("dy",.25*q.left).style("text-anchor","middle").style("font-size","1px").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").text(d).style("font-size",function(a){var b=this.getBBox(),e=(b.width,b.height,Math.min(t/(b.width+1),r/(b.height+1),20,.04*n,.04*m));return e+"px"});var s=J.selectAll(".factor1group").data(p).enter().append("g").attr("class","factor1group").attr("transform",function(a){return"translate("+y(a.key)+",0)"});s.append("g").attr("class","x1 axis").attr("transform","translate(0,"+t+")").call(G).style("font-size","12px");var K=J.selectAll(".axisticks1").data(p).enter().append("g").attr("class","axisticks1").attr("transform",function(a){return"translate("+y(a.key)+",0)"});K.filter(function(a,b){return b<p.length-1}).append("line").attr("class","group1tick").attr("x1",y.bandwidth()/2+y.bandwidth()/(2-2*u)).attr("y1",t).attr("x2",y.bandwidth()/2+y.bandwidth()/(2-2*u)).attr("y2",t+q.bottom).attr("stroke","black").attr("stroke-width",.002*n);var Q=s.selectAll(".factor2group").data(function(a){return a.values}).enter().append("g").attr("class","factor2group").attr("transform",function(a){return"translate("+z(a.key)+",0)"}),R=K.selectAll(".axisticks2").data(function(a){return a.values}).enter().append("g").attr("class","axisticks2").attr("transform",function(a){return"translate("+z(a.key)+",0)"});R.filter(function(a,b){return b<p[0].values.length-1}).append("line").attr("class","group2tick").attr("x1",z.bandwidth()/2+z.bandwidth()/(2-2*v)).attr("y1",t).attr("x2",z.bandwidth()/2+z.bandwidth()/(2-2*v)).attr("y2",t+q.bottom/3).attr("stroke","black").attr("stroke-width",.002*n);var S=Q.selectAll(".factor3group").data(function(a){return a.values}).enter().append("g").attr("class","factor3group").attr("transform",function(a){return"translate("+A(a.key)+",0)"}),T=R.selectAll(".axisticks3").data(function(a){return a.values}).enter().append("g").attr("class","axisticks3").attr("transform",function(a){return"translate("+A(a.key)+",0)"});T.filter(function(a,b){return b<p[0].values[0].values.length-1}).append("line").attr("class","group3tick").attr("x1",A.bandwidth()/2+A.bandwidth()/(2-2*w)).attr("y1",t).attr("x2",A.bandwidth()/2+A.bandwidth()/(2-2*w)).attr("y2",t+q.bottom/5).attr("stroke","black").attr("stroke-width",.002*n),Z(".x0.axis text",y.bandwidth(),.02*m,0,.032*n),J.select("g.x.x0.axis").call(F),Z(".x1.axis text",z.bandwidth(),.015*m,0,.024*n),s.call(G),Q.append("g").attr("class","x2 axis").attr("transform","translate(0,"+t+")").call(H).style("font-size","10px").selectAll("text").style("text-anchor","middle"),Z(".x2.axis text",A.bandwidth(),.0125*m,0,.02*n),Q.call(H),J.selectAll("g.tick").filter(function(a){return 0!=a}).select("line").style("opacity","0.2"),J.selectAll("g.tick").select("line").attr("stroke-width",.002*n),J.selectAll(".axis path").attr("stroke-width",.002*n),J.selectAll("g.x1, g.x2").selectAll("path").attr("display","none"),J.selectAll(".y.axis").style("font-size",function(){return Math.min(.032*n,.032*m,16)+"px"});var U=S.selectAll("rect").data(function(a){return a.values}).enter().append("rect").attr("class","databar").attr("width",B.bandwidth()).attr("height",function(a){return Math.abs(C(a.values[0][d])-C(0))}).style("fill",function(a){return D(a.key)}).attr("x",function(a){return B(a.key)}).attr("y",t).transition().duration(500).attr("y",function(a){return a.values[0][d]>=0?C(a.values[0][d])+50/n:a.values[0][d]<0?C(0)+1-50/n:void 0});S.selectAll("rect").on("mouseover",function(a){var b=d3.select(this.parentNode).attr("transform"),c=b.substring(b.indexOf("(")+1,b.indexOf(")")).split(","),e=Number(c[0]),f=d3.select(this.parentNode.parentNode).attr("transform"),g=f.substring(f.indexOf("(")+1,f.indexOf(")")).split(","),h=Number(g[0]),i=d3.select(this.parentNode.parentNode.parentNode).attr("transform"),j=i.substring(i.indexOf("(")+1,i.indexOf(")")).split(","),k=Number(j[0]),l=parseFloat(d3.select(this).attr("x"))+e+h+k+B.bandwidth()/2;if(a.values[0][d]>=0)var o=parseFloat(d3.select(this).attr("y"))+1*parseFloat(d3.select(this).attr("height"))/4;else if(a.values[0][d]<0)var o=C(0)+3*parseFloat(d3.select(this).attr("height"))/4;var p=Math.max(B.bandwidth()/3,.02*m,.02*n);J.append("circle").attr("class","tooltip").attr("r",p).attr("cx",l).attr("cy",o).style("fill","aliceblue").style("pointer-events","none").style("stroke","black").style("stroke-width",.002*n+"px").style("stroke-opacity",.8).attr("fill-opacity",.8),J.append("text").attr("class","tooltip").attr("x",l).attr("y",o).attr("dy",Math.min(.4*p,8)+"px").attr("text-anchor","middle").attr("fill","black").style("pointer-events","none").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").text(a.values[0][d]),Z("text.tooltip",3*p/2,20,0,3*p/2)}).on("mouseout",function(){d3.selectAll(".tooltip").transition().duration(100).attr("fill-opacity",0).style("stroke-opacity",0).remove()});var V=S.selectAll(".errorbars").data(function(a){return a.values}).enter().append("g").attr("class","errorbars").style("pointer-events","none").attr("transform",function(a){var b=B(a.key)+B.bandwidth()/2;return"translate("+b+", 0 )"});V.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",E).attr("x1",0).attr("y1",t).attr("x2",0).attr("y2",t).transition().duration(500).attr("x1",0).attr("y1",function(a){var b=a.values[0][d]+a.values[0].stderror;return C(b)}).attr("x2",0).attr("y2",function(a){var b=a.values[0][d]-a.values[0].stderror;return C(b)}),V.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",E).attr("x1",-B.bandwidth()/4).attr("y1",t).attr("x2",B.bandwidth()/4).attr("y2",t).transition().duration(500).attr("x1",-B.bandwidth()/4).attr("y1",function(a){var b=a.values[0][d]+a.values[0].stderror;return C(b)}).attr("x2",B.bandwidth()/4).attr("y2",function(a){var b=a.values[0][d]+a.values[0].stderror;return C(b)}).attr("stroke","black").attr("stroke-width",E),V.append("line").attr("class","errorline").attr("stroke","black").attr("stroke-width",E).attr("x1",-B.bandwidth()/4).attr("y1",t).attr("x2",B.bandwidth()/4).attr("y2",t).transition().duration(500).attr("x1",-B.bandwidth()/4).attr("y1",function(a){var b=a.values[0][d]-a.values[0].stderror;return C(b)}).attr("x2",B.bandwidth()/4).attr("y2",function(a){var b=a.values[0][d]-a.values[0].stderror;return C(b)}).attr("stroke","black").attr("stroke-width",E);var $=J.selectAll(".legend").data(p[0].values[0].values[0].values).enter().append("g").attr("class","legend").attr("transform",function(a,b){var c=b*X+X;return"translate(0,"+c+")"});$.append("rect").attr("x",m-q.left-Y).attr("width",Y).attr("height",Y).style("fill",function(a){return D(a.key)}),$.append("text").attr("x",.991489*(m-q.left-Y)).attr("y",Y/2).attr("dy",Y/3.2).style("text-anchor","end").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").text(function(a){return a.key}).classed("legendtext",!0);var _=J.append("g").attr("transform",function(){var a=m-q.left;return"translate("+a+","+X/2+")"}).append("text").attr("class","legendtitle").text(h).attr("x",0).attr("y",0).style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").style("text-anchor","end"),aa=J.append("g").attr("class","axiscontrolstitle").attr("transform",function(){var a=m-q.left,b=p[0].values[0].values[0].values.length*X+4.7*X;return"translate("+a+","+b+")"});aa.append("text").text("X axis Flips").classed("morphtext3",!0).classed("fliptitle",!0).attr("x",-W/2).attr("y",0).style("fill","steelblue").style("text-anchor","middle").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif");var ba=["Flip "+h,"Flip "+g,"Flip "+f,"Flip "+e],ca=[e+","+f+","+g+","+h,e+","+f+","+h+","+g,e+","+g+","+f+","+h,e+","+g+","+h+","+f,e+","+h+","+f+","+g,e+","+h+","+g+","+f,f+","+e+","+g+","+h,f+","+e+","+h+","+g,f+","+g+","+e+","+h,f+","+g+","+h+","+e,f+","+h+","+e+","+g,f+","+h+","+g+","+e,g+","+e+","+f+","+h,g+","+e+","+h+","+f,g+","+f+","+e+","+h,g+","+f+","+h+","+e,g+","+h+","+e+","+f,g+","+h+","+f+","+e,h+","+e+","+f+","+g,h+","+e+","+g+","+f,h+","+f+","+e+","+g,h+","+f+","+g+","+e,h+","+g+","+e+","+f,h+","+g+","+f+","+e],da=J.selectAll(".morphbutton").data(ba).enter().append("g").attr("class",function(a,b){return"morphbutton"+b}).attr("transform",function(a,b){var c=m-q.left-W,d=p[0].values[0].values[0].values.length*X+b*(X+1)+5*X;return"translate("+c+","+d+")"});da.append("rect").attr("width",W).attr("height",X).attr("rx","5").attr("ry","5").style("fill","#C0C0C0").on("mousedown",function(){d3.select(this).style("fill","darkgrey")}).on("mouseout",function(){d3.select(this).style("fill","#C0C0C0")}).on("mouseup",function(){d3.select(this).style("fill","#C0C0C0")}),da.append("text").text(function(a){return a}).classed("morphtext",!0).attr("x",W/2).attr("y",3*X/4).style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").style("text-anchor","middle").style("fill","white").style("pointer-events","none");var fa=(d3.select(b).append("div").text("Factor Hierarchy (last is legend)").style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").style("font-style","italic").style("color","steelblue"),d3.select(b).append("select").attr("class","select").attr("name","redrawlist").attr("transform",function(){var a=m-q.left-W,b=p[0].values[0].values[0].values.length*X+ba.length*(X+1)+5*X;return"translate("+a+","+b+")"})),ga=fa.selectAll("option").data(ca).enter().append("option");ga.text(function(a){return a}).attr("value",function(a){return a}).style("font-family","'Droid Sans', Helvetica, Arial, sans-serif").style("font-size","12px"),Z(".morphtext",W-5,16,0,X),Z(".morphtext3",q.legend,16,6,X),Z(".legendtext",q.legend-Y,16,0,Y),Z(".legendtitle",q.legend-Y,16,6,Y),d3.selectAll("text.legendtitle").style("font-weight","bold"),d3.selectAll("text.fliptitle").style("font-weight","bold"),d3.selectAll(".redrawtitle text").style("font-style","italic"),da.filter(function(a,b){return"morphbutton0"==d3.select(this).attr("class")}).style("font-style","italic").on("click",function(){0==P&&(P=1,0==L?(B.rangeRound([A.bandwidth(),0]),L=1):1==L&&(B.rangeRound([0,A.bandwidth()]),L=0),S.selectAll("rect").data(function(a){return a.values}).transition().attr("width",B.bandwidth()).attr("x",function(a){
return B(a.key)}).attr("y",function(a){return C(Math.max(0,a.values[0][d]))+.001*n}).attr("height",function(a){return Math.abs(C(a.values[0][d])-C(0))}).style("fill",function(a){return D(a.key)}),S.selectAll(".errorbars").data(function(a){return a.values}).transition().attr("transform",function(a){var b=B(a.key)+B.bandwidth()/2;return"translate("+b+", 0 )"}).call(function(){P=0}))}),da.filter(function(a,b){return"morphbutton1"==d3.select(this).attr("class")}).style("font-style","italic").on("click",function(){0==P&&(P=1,0==M?(A.rangeRound([z.bandwidth(),0]).padding(w),M=1):1==M&&(A.rangeRound([0,z.bandwidth()]).padding(w),M=0),Q.selectAll(".x2.axis").transition().call(H),Q.selectAll("g.factor3group").data(function(a){return a.values}).transition().attr("transform",function(a){return"translate("+A(a.key)+",0)"}),setTimeout(function(){P=0},500))}),da.filter(function(a,b){return"morphbutton2"==d3.select(this).attr("class")}).style("font-style","italic").on("click",function(){0==P&&(P=1,0==N?(z.rangeRound([y.bandwidth(),0]).padding(v),N=1):1==N&&(z.rangeRound([0,y.bandwidth()]).padding(v),N=0),s.selectAll(".x1.axis").transition().call(G),s.selectAll("g.factor2group").data(function(a){return a.values}).transition().attr("transform",function(a){return"translate("+z(a.key)+",0)"}),setTimeout(function(){P=0},500))}),da.filter(function(a,b){return"morphbutton3"==d3.select(this).attr("class")}).style("font-style","italic").on("click",function(){0==P&&(P=1,0==O?(y.rangeRound([r,0]).padding(u),O=1):1==O&&(y.rangeRound([0,r]).padding(u),O=0),J.select("g.x.x0.axis").transition().call(F),J.selectAll("g.factor1group").data(p).transition().attr("transform",function(a){return"translate("+y(a.key)+",0)"}),setTimeout(function(){P=0},500))}),fa.on("change",ha)})}var colorpalettes={defaultcolors:{1:["#5DA5DA"],2:["#5DA5DA","#60BD68"],3:["#5DA5DA","#60BD68","#F15854"],4:["#5DA5DA","#F15854","#60BD68","#845C59"],5:["#5DA5DA","#F15854","#60BD68","#845C59","#FAA43A"],6:["#5DA5DA","#F15854","#60BD68","#845C59","#FAA43A","#41977E"],7:["#5DA5DA","#F15854","#60BD68","#845C59","#FAA43A","#41977E","#F17CB0"],8:["#5DA5DA","#F15854","#60BD68","#845C59","#FAA43A","#41977E","#F17CB0","#DECF3F"],9:["#5DA5DA","#F15854","#60BD68","#845C59","#FAA43A","#41977E","#F17CB0","#DECF3F","#B276B2"],10:["#5DA5DA","#F15854","#60BD68","#845C59","#FAA43A","#41977E","#F17CB0","#DECF3F","#B276B2","#C2D580"]}};